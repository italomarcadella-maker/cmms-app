module.exports=[59689,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(32674),f=a.i(17002),g=a.i(74368),h=a.i(210),i=a.i(41675),j=a.i(46842),k=a.i(67453),l=a.i(41710),m=a.i(80032),n=a.i(73570),o=a.i(70106);let p=(0,o.default)("banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);var q=a.i(38246),r=a.i(36174),s=a.i(23045);let t=(0,o.default)("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),u=(0,o.default)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);function v({workOrderId:a,items:d,onUpdate:e}){let[f,g]=(0,c.useState)(d||[]),h=d||f,i=h.length>0?Math.round(h.filter(a=>a.completed).length/h.length*100):0;return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,b.jsx)(t,{className:"h-5 w-5 text-primary"}),"Checklist Esecuzione"]}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[i,"% Completato"]})]}),(0,b.jsx)("div",{className:"w-full bg-secondary h-2 rounded-full overflow-hidden mb-6",children:(0,b.jsx)("div",{className:"bg-primary h-full transition-all duration-500 ease-out",style:{width:`${i}%`}})}),(0,b.jsxs)("div",{className:"space-y-2",children:[0===h.length&&(0,b.jsx)("p",{className:"text-muted-foreground text-sm italic",children:"Nessuna voce nella checklist."}),h.map(c=>(0,b.jsxs)("div",{onClick:()=>{var b;let d;return b=c.id,d=h.map(a=>a.id===b?{...a,completed:!a.completed}:a),void(e&&a?e(a,{checklist:d}):g(d))},className:"flex items-center gap-3 p-3 rounded-lg border bg-card hover:bg-muted/50 cursor-pointer transition-colors",children:[(0,b.jsx)("div",{className:`flex-shrink-0 ${c.completed?"text-primary":"text-muted-foreground"}`,children:c.completed?(0,b.jsx)(t,{className:"h-5 w-5"}):(0,b.jsx)(u,{className:"h-5 w-5"})}),(0,b.jsx)("span",{className:`text-sm ${c.completed?"line-through text-muted-foreground":"font-medium"}`,children:c.label})]},c.id))]})]})}function w(){let a=(0,d.useParams)(),{workOrders:o,updateWorkOrder:t}=(0,e.useWorkOrders)(),{parts:u,updateQuantity:w}=(0,f.useInventory)(),{technicians:x}=(0,g.useReference)(),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(1),K=o.find(b=>b.id===a.id)||o.find(b=>b.id===decodeURIComponent(a.id));if(!K)return(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center p-12 text-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Ordine di Lavoro Non Trovato"}),(0,b.jsxs)(q.default,{href:"/work-orders",className:"text-primary hover:underline mt-4 flex items-center gap-2",children:[(0,b.jsx)(h.ArrowLeft,{className:"h-4 w-4"})," Torna alla Lista"]})]});let L=K.partsUsed?.reduce((a,b)=>a+b.quantity*b.unitCost,0)||0,M=(K.laborLogs||[]).reduce((a,b)=>{let c=x.find(a=>a.id===b.technicianId),d=c?.hourlyRate||0;return a+b.hours*d},0),N=L+M;return(0,b.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-500",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(q.default,{href:"/work-orders",className:"p-2 rounded-full hover:bg-muted text-muted-foreground",children:(0,b.jsx)(h.ArrowLeft,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-foreground to-foreground/60 bg-clip-text text-transparent",children:"Dettaglio Ordine di Lavoro"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground mt-1",children:[(0,b.jsx)("span",{className:"font-mono bg-muted px-2 rounded text-sm",children:K.id}),(0,b.jsx)("span",{children:"•"}),(0,b.jsxs)("span",{children:["Creato il ",new Date(K.createdAt).toLocaleDateString()]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,b.jsx)("div",{className:"rounded-xl border bg-card p-6 shadow-sm flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground font-medium",children:"Stato"}),(0,b.jsx)(s.WOStatusBadge,{status:K.status})]})}),(0,b.jsx)("div",{className:"rounded-xl border bg-card p-6 shadow-sm flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground font-medium",children:"Priorità"}),(0,b.jsx)(r.WOPriorityBadge,{priority:K.priority})]})})]}),(0,b.jsxs)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Descrizione"}),(0,b.jsx)("p",{className:"text-muted-foreground leading-relaxed",children:K.description}),(0,b.jsxs)("div",{className:"mt-4 pt-4 border-t flex gap-6 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground block mb-1",children:"Asset"}),(0,b.jsxs)(q.default,{href:`/assets/${K.assetId}`,className:"font-medium hover:underline text-primary flex items-center gap-1",children:[(0,b.jsx)(m.Box,{className:"h-3 w-3"})," ",K.assetName]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground block mb-1",children:"Assegnato a"}),(0,b.jsxs)("div",{className:"font-medium flex items-center gap-1",children:[(0,b.jsx)(j.User,{className:"h-3 w-3"})," ",K.assignedTo]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground block mb-1",children:"Scadenza"}),(0,b.jsxs)("div",{className:"font-medium flex items-center gap-1",children:[(0,b.jsx)(i.Calendar,{className:"h-3 w-3"})," ",K.dueDate]})]})]})]}),(0,b.jsx)(v,{workOrderId:K.id,items:K.checklist,onUpdate:t})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"font-semibold text-sm uppercase tracking-wider text-muted-foreground mb-4",children:"Azioni Rapide"}),(0,b.jsxs)("div",{className:"space-y-2",children:["PENDING_APPROVAL"===K.status?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("button",{onClick:()=>t(K.id,{status:"COMPLETED"}),className:"w-full text-left px-4 py-2 bg-green-50 text-green-700 hover:bg-green-100 rounded text-sm font-medium transition-colors flex items-center gap-2",children:[(0,b.jsx)(k.CheckCircle2,{className:"h-4 w-4"})," Approva e Chiudi"]}),(0,b.jsxs)("button",{onClick:()=>t(K.id,{status:"IN_PROGRESS"}),className:"w-full text-left px-4 py-2 hover:bg-muted rounded text-sm font-medium transition-colors flex items-center gap-2 text-red-600",children:[(0,b.jsx)(n.AlertTriangle,{className:"h-4 w-4"})," Rifiuta e Riapri"]})]}):"COMPLETED"!==K.status?(0,b.jsxs)("button",{onClick:()=>t(K.id,{status:"PENDING_APPROVAL"}),className:"w-full text-left px-4 py-2 hover:bg-muted rounded text-sm font-medium transition-colors flex items-center gap-2",children:[(0,b.jsx)(k.CheckCircle2,{className:"h-4 w-4 text-emerald-500"})," Richiedi Approvazione"]}):(0,b.jsx)("div",{className:"text-center text-sm text-green-600 font-medium py-2 border rounded bg-green-50",children:"Ordine Completato"}),"COMPLETED"!==K.status&&"PENDING_APPROVAL"!==K.status&&(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2 hover:bg-muted rounded text-sm font-medium transition-colors flex items-center gap-2",children:[(0,b.jsx)(n.AlertTriangle,{className:"h-4 w-4 text-amber-500"})," Segnala Problema"]})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)(p,{className:"h-5 w-5 text-emerald-600"}),(0,b.jsx)("h3",{className:"font-semibold text-lg",children:"Materiali & Costi"})]}),(0,b.jsxs)("div",{className:"mb-6 border-b pb-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("h4",{className:"text-sm font-semibold flex items-center gap-2",children:[(0,b.jsx)(m.Box,{className:"h-4 w-4"})," Materiali Utilizzati"]}),(0,b.jsx)("button",{onClick:()=>z(!y),className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded hover:bg-primary/20",children:"+ Aggiungi"})]}),y&&(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b=u.find(a=>a.id===A);if(!b)return;if(b.quantity<C)return void alert("Insufficient quantity in inventory!");w(b.id,b.quantity-C);let c={partId:b.id,partName:b.name,quantity:C,unitCost:b.unitCost||0,dateAdded:new Date().toISOString()},d=K.partsUsed||[];t(K.id,{partsUsed:[...d,c]}),z(!1),B(""),D(1)},className:"bg-muted/30 p-3 rounded-lg space-y-3 mb-3 animate-in fade-in zoom-in-95",children:[(0,b.jsx)("div",{children:(0,b.jsxs)("select",{required:!0,className:"w-full text-sm rounded-md border bg-background px-3 py-2",value:A,onChange:a=>B(a.target.value),children:[(0,b.jsx)("option",{value:"",children:"Seleziona Ricambio..."}),u.map(a=>(0,b.jsxs)("option",{value:a.id,disabled:a.quantity<=0,children:[a.name," (Disp: ",a.quantity,")"]},a.id))]})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"number",min:"1",required:!0,placeholder:"Qtà",className:"w-20 text-sm rounded-md border bg-background px-3 py-2",value:C,onChange:a=>D(Number(a.target.value))}),(0,b.jsx)("button",{type:"submit",className:"flex-1 bg-primary text-primary-foreground px-3 py-2 rounded text-sm font-medium",children:"Scarica"})]})]}),K.partsUsed&&0!==K.partsUsed.length?(0,b.jsx)("div",{className:"space-y-2",children:K.partsUsed.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm p-2 bg-muted/20 rounded-md",children:[(0,b.jsx)("span",{className:"font-medium truncate max-w-[120px]",children:a.partName}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-muted-foreground",children:[(0,b.jsxs)("span",{children:["x",a.quantity]}),(0,b.jsxs)("span",{children:["€",(a.unitCost*a.quantity).toFixed(2)]})]})]},c))}):(0,b.jsx)("div",{className:"text-sm text-muted-foreground italic py-1",children:"Nessun materiale utilizzato."})]}),(0,b.jsxs)("div",{className:"space-y-3 mb-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Costo Ricambi"}),(0,b.jsxs)("span",{className:"font-mono",children:["€",L.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Costo Manodopera"}),(0,b.jsxs)("span",{className:"font-mono",children:["€",M.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"pt-2 border-t flex justify-between font-bold text-base",children:[(0,b.jsx)("span",{children:"Totale"}),(0,b.jsxs)("span",{children:["€",N.toFixed(2)]})]})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,b.jsx)(l.Clock,{className:"h-4 w-4"})," Manodopera"]}),(0,b.jsx)("button",{onClick:()=>F(!E),className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded hover:bg-primary/20",children:"+ Aggiungi Ore"})]}),E&&(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b=x.find(a=>a.id===G);if(!b)return;let c={id:`LOG-${Date.now()}`,technicianId:b.id,technicianName:b.name,hours:I,date:new Date().toISOString()},d=K.laborLogs||[];t(K.id,{laborLogs:[...d,c]}),F(!1),H(""),J(1)},className:"bg-muted/30 p-4 rounded-lg space-y-3 animate-in fade-in zoom-in-95",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,b.jsxs)("div",{className:"sm:col-span-2",children:[(0,b.jsx)("label",{className:"text-xs font-medium mb-1 block",children:"Tecnico"}),(0,b.jsxs)("select",{required:!0,className:"w-full text-sm rounded-md border bg-background px-3 py-2",value:G,onChange:a=>H(a.target.value),children:[(0,b.jsx)("option",{value:"",children:"Seleziona Tecnico..."}),x.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," (€",a.hourlyRate,"/h)"]},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs font-medium mb-1 block",children:"Ore"}),(0,b.jsx)("input",{type:"number",min:"0.5",step:"0.5",required:!0,className:"w-full text-sm rounded-md border bg-background px-3 py-2",value:I,onChange:a=>J(Number(a.target.value))})]})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)("button",{type:"submit",className:"bg-primary text-primary-foreground px-3 py-1.5 rounded text-sm font-medium",children:"Aggiungi"})})]}),K.laborLogs&&0!==K.laborLogs.length?(0,b.jsx)("div",{className:"space-y-2",children:K.laborLogs.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm p-2 bg-muted/20 rounded-md",children:[(0,b.jsx)("span",{className:"font-medium",children:a.technicianName}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-muted-foreground",children:[(0,b.jsxs)("span",{children:[a.hours,"h"]}),(0,b.jsx)("span",{className:"text-xs",children:new Date(a.date).toLocaleDateString()})]})]},a.id))}):(0,b.jsx)("div",{className:"text-sm text-muted-foreground italic py-2",children:"Nessuna attività registrata."})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"rounded-xl border bg-card p-6 shadow-sm space-y-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-sm uppercase tracking-wider text-muted-foreground",children:"Dettagli"}),(0,b.jsxs)("div",{className:"flex justify-between items-center py-2 border-b",children:[(0,b.jsx)("span",{className:"text-sm",children:"Stato"}),(0,b.jsx)(s.WOStatusBadge,{status:K.status})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center py-2 border-b",children:[(0,b.jsx)("span",{className:"text-sm",children:"Priorità"}),(0,b.jsx)(r.WOPriorityBadge,{priority:K.priority})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 py-2 border-b",children:[(0,b.jsx)(j.User,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"Assegnato a"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:K.assignedTo})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 py-2",children:[(0,b.jsx)(i.Calendar,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"Scadenza"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:K.dueDate})]})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border bg-card p-6 shadow-sm space-y-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-sm uppercase tracking-wider text-muted-foreground",children:"Riepilogo Costi"}),(0,b.jsxs)("div",{className:"space-y-2 py-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Ricambi"}),(0,b.jsxs)("span",{children:["€",L.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Manodopera"}),(0,b.jsxs)("span",{children:["€",M.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"border-t pt-2 mt-2 flex justify-between font-bold text-lg",children:[(0,b.jsx)("span",{children:"Totale"}),(0,b.jsxs)("span",{children:["€",N.toFixed(2)]})]})]})]})]})]})]})}a.s(["default",()=>w],59689)}];

//# sourceMappingURL=app_%28dashboard%29_work-orders_%5Bid%5D_page_tsx_d290f6d1._.js.map