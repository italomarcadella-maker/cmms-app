module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},96221,a=>{"use strict";let b=(0,a.i(70106).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},33441,a=>{"use strict";let b=(0,a.i(70106).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);a.s(["Check",()=>b],33441)},13e3,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(96221),f=a.i(38246),g=a.i(32674),h=a.i(20285),i=a.i(74368),j=a.i(33508),k=a.i(33441),l=a.i(97895);function m({label:a,options:d,value:e,onChange:f,placeholder:g,onCreate:h}){let[i,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(""),p=(0,c.useRef)(null);(0,c.useEffect)(()=>{let a=a=>{p.current&&!p.current.contains(a.target)&&m(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);let q=()=>{n.trim()&&h&&(h(n.trim()),o(""))},r=e.map(a=>d.find(b=>b.id===a)?.label).filter(Boolean);return(0,b.jsxs)("div",{className:"space-y-2",ref:p,children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:a}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("div",{className:"min-h-10 w-full rounded-md border bg-background px-3 py-2 text-sm focus-within:ring-2 focus-within:ring-primary cursor-pointer flex flex-wrap gap-2",onClick:()=>m(!i),children:[0===r.length&&(0,b.jsx)("span",{className:"text-muted-foreground",children:g||"Select..."}),r.map((a,c)=>(0,b.jsxs)("span",{className:"bg-primary/10 text-primary text-xs px-2 py-1 rounded-full flex items-center gap-1",children:[a,(0,b.jsx)("span",{role:"button",onClick:b=>{b.stopPropagation(),f(e.filter(b=>d.find(a=>a.id===b)?.label!==a))},className:"hover:text-primary/70",children:(0,b.jsx)(j.X,{className:"h-3 w-3"})})]},c))]}),i&&(0,b.jsxs)("div",{className:"absolute z-50 w-full mt-1 rounded-md border bg-background text-foreground shadow-lg max-h-60 overflow-y-auto p-1 ring-1 ring-black/5",children:[h&&(0,b.jsxs)("div",{className:"flex gap-2 p-2 border-b mb-1",children:[(0,b.jsx)("input",{className:"flex-1 bg-transparent text-sm outline-none",placeholder:"Create new...",value:n,onChange:a=>o(a.target.value),onClick:a=>a.stopPropagation(),onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),q())}}),(0,b.jsx)("button",{type:"button",onClick:a=>{a.stopPropagation(),q()},className:"text-xs font-medium text-primary",children:"Add"})]}),d.map(a=>(0,b.jsxs)("div",{className:(0,l.cn)("flex items-center justify-between px-2 py-1.5 text-sm rounded-sm cursor-pointer hover:bg-accent hover:text-accent-foreground",e.includes(a.id)&&"bg-accent/50"),onClick:()=>{var b;return b=a.id,void(e.includes(b)?f(e.filter(a=>a!==b)):f([...e,b]))},children:[a.label,e.includes(a.id)&&(0,b.jsx)(k.Check,{className:"h-4 w-4 text-primary"})]},a.id))]})]})]})}function n(){let a=(0,d.useRouter)(),j=(0,d.useSearchParams)(),{addWorkOrder:k}=(0,g.useWorkOrders)(),{assets:l}=(0,h.useAssets)(),{activities:n,technicians:o,addActivity:p,addTechnician:q}=(0,i.useReference)(),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)([]),v=j.get("assetId")||"",w=j.get("title")||"",x=j.get("priority")||"LOW";async function y(b){b.preventDefault(),s(!0);let c=new FormData(b.currentTarget);await new Promise(a=>setTimeout(a,800));let d=c.get("assetId"),e=l.find(a=>a.id===d),f=t.map((a,b)=>{let c=n.find(b=>b.id===a);return{id:`CHK-${Math.floor(1e4*Math.random())}`,label:c?c.label:"Unknown Task",completed:!1}}),g=f.map(a=>a.label).join(", ")||c.get("description"),h=c.get("assignedTechnicianId"),i=o.find(a=>a.id===h);k({id:`WO-${Math.floor(1e4*Math.random())}`,title:c.get("title"),description:g||"Maintenance Task",assetId:d,assetName:e?e.name:"Unknown Asset",priority:c.get("priority"),status:"OPEN",assignedTo:i?i.name:"Unassigned",assignedTechnicianId:h,dueDate:c.get("dueDate"),createdAt:new Date().toISOString().split("T")[0],checklist:f,category:c.get("category")||"OTHER",partsUsed:[],laborLogs:[]}),s(!1),a.push("/work-orders")}return(0,b.jsxs)("form",{onSubmit:y,className:"space-y-8 max-w-2xl",children:[(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border bg-card p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"text-lg font-medium",children:"Dettagli Task"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"title",className:"text-sm font-medium",children:"Titolo"}),(0,b.jsx)("input",{required:!0,id:"title",name:"title",defaultValue:w,className:"flex h-10 w-full rounded-md border bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-primary outline-none",placeholder:"es. Guarnizione rotta"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"category",className:"text-sm font-medium",children:"Categoria"}),(0,b.jsxs)("select",{required:!0,id:"category",name:"category",className:"flex h-10 w-full rounded-md border bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-primary outline-none",children:[(0,b.jsx)("option",{value:"MECHANICAL",children:"Meccanica"}),(0,b.jsx)("option",{value:"ELECTRICAL",children:"Elettrica"}),(0,b.jsx)("option",{value:"HYDRAULIC",children:"Idraulica"}),(0,b.jsx)("option",{value:"PNEUMATIC",children:"Pneuamtica"}),(0,b.jsx)("option",{value:"OTHER",children:"Altro"})]})]}),(0,b.jsx)(m,{label:"Attività di Manutenzione (Checklist)",options:n.map(a=>({id:a.id,label:a.label})),value:t,onChange:u,onCreate:p,placeholder:"Seleziona task..."}),(0,b.jsx)("input",{type:"hidden",name:"description",value:t.map(a=>n.find(b=>b.id===a)?.label).join(", ")})]})]}),(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border bg-card p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"text-lg font-medium",children:"Pianificazione"}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"assetId",className:"text-sm font-medium",children:"Asset"}),(0,b.jsxs)("select",{required:!0,id:"assetId",name:"assetId",defaultValue:v,className:"flex h-10 w-full rounded-md border bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-primary outline-none",children:[(0,b.jsx)("option",{value:"",children:"Seleziona un asset..."}),l.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," (",a.serialNumber,")"]},a.id))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"priority",className:"text-sm font-medium",children:"Priorità"}),(0,b.jsxs)("select",{required:!0,id:"priority",name:"priority",defaultValue:x,className:"flex h-10 w-full rounded-md border bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-primary outline-none",children:[(0,b.jsx)("option",{value:"LOW",children:"Bassa"}),(0,b.jsx)("option",{value:"MEDIUM",children:"Media"}),(0,b.jsx)("option",{value:"HIGH",children:"Alta"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"assignedTechnicianId",className:"text-sm font-medium",children:"Tecnico Assegnato"}),(0,b.jsxs)("select",{id:"assignedTechnicianId",name:"assignedTechnicianId",required:!0,className:"flex h-10 w-full rounded-md border bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-primary outline-none",children:[(0,b.jsx)("option",{value:"",children:"Seleziona tecnico..."}),o.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," (",a.specialty,")"]},a.id))]}),(0,b.jsx)("input",{type:"hidden",name:"assignedTo"})," "]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"dueDate",className:"text-sm font-medium",children:"Scadenza"}),(0,b.jsx)("input",{required:!0,type:"date",id:"dueDate",name:"dueDate",className:"flex h-10 w-full rounded-md border bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-primary outline-none"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(f.default,{href:"/work-orders",className:"inline-flex items-center justify-center rounded-md border bg-background px-4 py-2 text-sm font-medium hover:bg-muted",children:"Annulla"}),(0,b.jsxs)("button",{disabled:r,type:"submit",className:"inline-flex items-center gap-2 rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground hover:bg-primary/90 disabled:opacity-50",children:[r&&(0,b.jsx)(e.Loader2,{className:"h-4 w-4 animate-spin"}),"Crea Ordine"]})]})]})}a.s(["WorkOrderForm",()=>n],13e3)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__48005604._.js.map